<!DOCTYPE html>
<html>
	<meta charset="UTF-8" />
	<link REL="SHORTCUT ICON" HREF="img/favicon.ico">
	<title>PrimaryAccess Prep</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
	<script src="lib/jquery.ui.touch-punch.min.js"></script>
	<script src="images.js"></script>
	<style type="text/css">
		 body { 			font-family: Verdana,Geneva,sans-serif; font-size: 13px;  
							padding: 0; margin: 0px;
							}
		.pa-main {		 	height: 100vh; width: 100vw; min-width: 500px; min-height: 500px; overflow: auto;  
							background-color:#fff; opacity: 0;
							}
		.pa-tabs { 			background-color:#fff;  font-size: 14px; margin: 24px 0 0 16px; cursor: pointer;
							}
		.pa-tab { 			display: inline-block; width: auto; border-top-left-radius: 8px;  border-top-right-radius: 8px;
							padding: 4px 12px 2px 8px; background-color:#eee; border: 1px solid #999;
							}
		.pa-body { 			width: calc(100% - 56px); height: calc(100vh - 88px); padding: 12px 12px; margin-left: 16px; margin-top:-1px;
							border-bottom-left-radius: 8px;  border-bottom-right-radius: 8px;  border-top-right-radius: 8px;
							background-color:#fff;  border: 1px solid #999;
							}
		.pa-greenbs {		border-radius: 16px; padding-left: 8px; padding-right: 8px; display: inline-block; height: 17px; padding-top: 1px;
							font-size: 12px; background-color: #27ae60; cursor: pointer; text-align: center; color:#fff; 
							}
		.pa-dialog {	 	position: absolute; left: 28px; top: 60px;
							user-select: none; width: 685px; border-radius:14px; background-color:#eee; box-shadow:4px 4px 8px #ccc;
							margin-top: 0%; padding: 12px; font-size: 12px; 
							}
		.pa-dialogLabel {	font-size: 18px; text-shadow: 1px 1px #ccc; color:#27ae60; font-weight: bold;
							}
		.pa-dialogTitle {	font-weight: bold; color: #000; padding-left: 8px; padding-right: 8px;
							}
		.pa-dialogDoneBut {	cursor: pointer; float: right;
							} 
		.pa-dialogResults { width: 100%px; height: 350px; overflow-y: auto; border-radius: 6px;
							background-color :#f8f8f8; padding: 8px; border: 1px solid #999;
							}
		.pa-prevDiv {		position: absolute; background-color:#eee; padding: 0px; padding-top: 0px;  overflow-x: hidden; 
							overflow-y: auto; z-index: 10000; border-left: 1px solid #999; text-align: right;
							}
		.pa-prevId {		font-size: 14px; color: #27ae60; font-weight: bold; padding-left: 8px; padding-right: 8px;
							}
		.pa-listItem {		height: 20px; cursor: pointer; background-color: #f8f8f8; color:#000;
							}
		.pa-listItem:hover{ background-color: #dee7f1;
							}
		.pa-gridItem {		color: #666; padding: 8px;  border: 1px solid #47ae80; margin-right: 8px; margin-bottom: 8px; display: inline-block;
							width: 190px; height: 154px; cursor: pointer; border-radius: 4px; overflow: hidden;
							}
		.pa-gridItem:hover{ background-color: #dee7f1;
							}
		.pa-gridPic {		width: 100%; height: 100px; overflow: hidden; margin-bottom: 6px;
							}

		/* MISC --------------------------------------------------------------------------------------------------*/
	
		.pa-splash			{ position:absolute; left: calc(50% - 182px); top:  calc(40% - 51px); 
							color: #999; font-size: 36px; text-align:center; font-weight: bold;
							}
		.pa-webpage	{ 		position: absolute; padding: 12px; border-radius: 6px; display: none; padding: 12px; height:auto; font-size: 14px; 
							border: 1px solid #999; background-color:#eee; font-size: 11px; box-shadow: 4px 4px 12px 2px #aaa;
							}
		.pa-is {			border-radius:10px; padding-left: 8px; padding-right: 8px; padding-top: 1px;
							border: 1px solid #999; font-size: 12px; height: 20px; width: 300px;
							}
		.pa-bs {			display: inline-block; border-radius: 10px; padding-left: 8px; padding-right: 8px; background-color:#ccc; color: #333;
							border: 1px solid #999; font-size: 12px; height: 16px; cursor: pointer; width: 50px; text-align:center;
							}
		.pa-ok {			display:inline-block; border-radius: 20px; height: 18px; width: 22px; cursor: pointer;
							border: 1px solid #666; color: #666; font-size: 10px; padding-top: 4px;
							}
		.pa-popup {			position: absolute;  width: auto; padding: 8px; left: calc(50% - 100px); top: calc(50% - 50px);
							border-radius: 8px; background-color: #eee; border: 1px solid #999; box-shadow: 4px 2px 12px 2px #aaa; 
							font-size: 14px; text-align:center; display: none;
							}
	
		/* GLOBAL --------------------------------------------------------------------------------------------------*/
					
		.unselectable { 	-moz-user-select: none; -khtml-user-select: none; -webkit-user-select: none; -ms-user-select: none;  user-select: none;	
							}
		 table {			border-spacing: 0px;  }
		 input {		    vertical-align: -2px; }

							
	</style>
</head>
<body>
	<div id="mainDiv" class="pa-main">
		<img style="margin-right:12px;margin-top:8px;height:40px;float:right" src="img/palogo2.png">
		<div id="tabsDiv" class="pa-tabs">
			<div id="rosTabDiv" class="pa-tab unselectable">Roster</div>
			<div id="proTabDiv" class="pa-tab unselectable">Project</div>
			<div id="hlpTabDiv" class="pa-tab unselectable">Help</div>
		</div>
	<div id="bodyDiv" class="pa-body"></div>
	</div>
	<div id="splashDiv" class="pa-splash"><img src="img/palogo.gif"><br>Project Setup</div>

<script>

	var isMobile=false;														// Is a mobile platform
	var noSplash=(window.location == "localhost") ? false : true;			// Splash screen inhibitor
	var curTab="ros";														// Start on roster
	var roster=null;														// Holds roster module
	var projects=null;														// Holds projects module
	var pictures=null;														// Holds pictures module
	var picFind=null;														// Hold pic search module

	$(document).ready(function() {								        // ON PAGE LOADED
		isMobile=navigator.platform.match(/(ipad|iphone|ipod|android)/i) ? true : false; // Set mobile flag id ios
		if (!isMobile)														// Check for Android
			isMobile=navigator.userAgent.match(/android/i) ? true : false; 	// Set mobile flag
		var url=window.location.search.substring(1);					 	// Get query string
		roster=new CRoster();												// Alloc CRoster module
		projects=new CProject();											// Alloc CProject module
		picFind=new CImageFind();											// Alloc CImageFind module
		$(window).resize(ResizePanes);                                     	// On window resizing
		ResizePanes();														// Start up sizing
		Draw(curTab);														// Draw body

		$("#splashDiv").delay(noSplash?1:1000).animate({ opacity:0},noSplash?1:500, // Hide logo
				function() {	 											// When done
					if (url && url.match(/&fs/i)) 							// Full screen flag
						player.SetFullScreen(true);							// Set it
					$("#mainDiv").animate({ opacity:1},noSplash?500:2000, 	// Show interface
						function() {	$("#splashDiv").remove();	});		// Remove splash screen
					});		

		$(window).on("keydown",function(e) {								// HANDLE KEYPRESS
			if ((e.which == 84) && e.altKey && e.ctrlKey)					// TEST KEY
				gTest();
			});

		$("#rosTabDiv").on("click", function() {							// Roster tab click
			Sound("click");													// Click
			Draw("ros");													// Draw
			});
		$("#proTabDiv").on("click", function() {							// Project tab click
			Sound("click");													// Click
			Draw("pro");													// Draw
			});
		$("#hlpTabDiv").on("click", function() {							// Help tab click
			Sound("click");													// Click
			Draw("hlp");													// Draw
			});
	});
	

	function Draw(tab)
	{
		$("[id$=TabDiv]").css({ "border-bottom":"1px solid #999","background-color":"#eee","color":"#666" });
		$("#"+tab+"TabDiv").css({ "border-bottom":"1px solid #fff","background-color":"#fff","color":"#339933" });
		if (tab == "ros")		roster.Draw();									// Draw roster
		else if (tab == "pro")	projects.Draw();								// Draw projects
		else if (tab == "hlp")	ShowHelp();										// Show help
		}

	function ResizePanes()													//  REACT TO SCREEN SIZE
	{
	}

	function gTest()
	{
		trace(123)
	}

	function ShowHelp()														//  SHOW HELP
	{
		var h=$("#bodyDiv").height();										// Max height
		var w=h*.772;															// Letter spect
		str="<iframe src='https://docs.google.com/document/d/e/2PACX-1vQQlE8nxS33bkI5CY--daR1ibM-7q6B-GFrztW6cq9lN6FNztpA_b0nrQiV33krohd5O6dvyU1ibiGU/pub?embedded=true' "; 
		str+="style='width:"+w+"px;height:"+h+"px;overflow-y:scroll;border:none;margin-left:-8px;'></iframe>";
		$("#bodyDiv").html(str)
	}


////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// ROSTER
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	function CRoster()														// PLAYER CONSTRUCTOR
	{
	}

	CRoster.prototype.Draw=function() 										// UPDATE 
	{
		$("#bodyDiv").html("Roster")
	}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// PROJECT
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

	function CProject()														// PROJECT CONSTRUCTOR
	{
		this.pics=[];
	}

	CProject.prototype.Draw=function() 									// UPDATE
	{
		var _this=this;														// Context
		var str="<br><table style='min-width:400px;width:600px'>";
		str+="<tr><td>Current project</td><td>"+MakeSelect("proSet",false,["Civil Rights","Create new project"])+"</td></tr>";
		str+="<tr><td>Title of project</td><td><input id='proTitle' class='pa-is'></input></td></tr>";
		str+="<tr><td>Script/prompt</td><td><textarea id='proScript' class='pa-is' style='height:60px'></textarea></td></tr>";
		str+="<tr><td>Allow new pics?</td><td><input type='checkbox' id='proAdd' checked></input></td></tr>";
		str+="</table><br>Pictures:<hr><div id='picsBin'>None</div><br>"
		str+="<div id='addPics' class='pa-greenbs'>Add new picture</div>";
		
		$("#bodyDiv").html(str)
		
		$("#addPics").on("click", function() {								// ON ADD CLICK
			_this.AddPic();
			});

}

	CProject.prototype.AddPic=function() 								// ADD NEW PICTURE
	{
		var _this=this;														// Save context
		$("#dialogDiv").remove();											// Remove any old ones
		$("#bodyDiv").append("<div class='unselectable pa-dialog' style='width:500px' id='dialogDiv'</div>");	// Add to body													
		var str="<div style='display:inline-block'><table style='width:300px'>";	// Info div/table
		str+="<tr><td>Title</td><td><input id='addTitle' type='text' class='pa-is' style='width:100%'</td></tr>";
		str+="<tr><td>URL</td><td><input id='addUrl' type='text' class='pa-is' style='width:100%'></td></tr>";
		str+="<tr><td>Desc&nbsp;&nbsp;</td><td><textarea id='addDesc' type='text' class='pa-is' style='width:100%;height:50px'></textarea></td></tr>";
		str+="<tr><td>Link</td><td><input id='addLink' type='text' class='pa-is' style='width:100%'>";
		str+="</table></div>";														// End div
		str+="<div style='display:inline-block;overflow:hidden;width:160px;margin-left:32px;vertical-align:top'>";
		str+="<img id='addImg' src='img/newbinpic.png' style='width:100%;margin-bottom:8px'></div>";
		str+="<div id='findBut' class='pa-greenbs'>Find</div>";
		str+="<div style='float:right;margin-right:8px'>";
		str+="<div id='addBut' class='pa-bs'>Add</div>&nbsp;&nbsp";
		str+="<div id='cancelBut' class='pa-bs'>Cancel</div></div>";
		$("#dialogDiv").append(str);	
		$("#dialogDiv").draggable({ start: function(){ $("#previewDiv").remove(); } });	// Hide preview
			
		$("#findBut").on("click", function() {								// ON FIND
			picFind.ImportDialog(100, function(s) { trace(s) });
			});
		
		$("#addBut").on("click", function() {								// ON ADD
			var o={}
			o.src=$("#addUrl").val() ? $("#addUrl").val() : "";				// Add src
			o.title=$("#addTitle").val() ? $("#addTitle").val() : "";		// Add title
			o.desc=$("#addDesc").val() ? $("#addDesc").val() : "";			// Add desc
			o.link=$("#addLink").val() ? $("#addLink").val() : "";			// Add link
			if (!o.title && !o.src) { PopUp("Needs a title and a url",2000,"dialogDiv"); return; }	// Needs title and url
			if (!o.title) { PopUp("Needs a title",2000,"dialogDiv"); return; }	// Needs title 
			if (!o.src) { PopUp("Needs a url",2000,"dialogDiv"); return; }	//  Needs url
			_this.pics.push(o);												// Add to bin
			Sound("ding");													// Ding
			$("#dialogDiv").remove();										// Remove 
			});
		
		$("#cancelBut").on("click", function() {							// ON CANCEL
			$("#dialogDiv").remove();										// Remove 
			});

		$("#addUrl").on("change", function() {								// ON IMAGE URL SET
			$("#addImg").prop("src",$(this).val());							// Show it
			});
	}


////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// HELPERS
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////


	function MakeSelect(id, multi, items, sel, extra, values)				// CREATE HTML SELECT
	{
		var	str="<select class='pa-is' id='"+id+"'";							// Header
		str+="style='width:auto'";
		if (multi)																// Multi select
			str+="multiple='multiple' size='"+multi+"'";						// Add flag
		if (extra)																// If extra param
			str+=extra;															// Add them
		str+=">";																// End header
		for (i=0;i<items.length;++i) {											// For each option
			str+="<option";														// Add tag
			if (sel == items[i])												// If selected
				str+=" selected='selected'"										// Add tag
			if (values && values[i])											// If has a value
				str+=" value='"+values[i]+"'";									// Add it
			str+=">"+items[i]+"</option>";										// End option
			}	
		return str+"</select>";													// Return element				
}

	function PopUp(msg, time, div)											// TIMED POPUP
	{
		var str="";
		$("#popupDiv").remove();												// Kill old one, if any
		str+="<div id='popupDiv' class='pa-popup'>"; 							// Add div
		if (time == -1) {														// If has close but
			time=100000;														// Increase time
			str+="<img id='pu-close' src='img/closedot.gif' style='float:right;cursor:pointer'>";	// Add close button
			}
		str+=msg+"</div>"; 														// Add div
		$(div ? "#"+div : "body").append(str);									// Add popup to div or body
		$("#pu-close").click(function() { $("#popupDiv").remove(); });			// Remove on click of close but
		$("#popupDiv").fadeIn(500).delay(time ? time : 2000).fadeOut(500)		// Animate in and out		
	}

	function DialogBox(title, content, x, y, width, callback, callback2) 	// DIALOG BOX
	{
		$("#dialogDiv").remove();												// Kill old one, if any
		var str="<div id='dialogDiv' class='pa-meta' style='width:"+width+"px'>"; // Add div
		str+="<b>"+title+"</b><br><br>"+content+"<br><br>";						// Content	
		str+="<div style='float:right'>"										// Div to hold buttons
		str+="<div id='okBut' class='pa-bs'>OK</div>&nbsp";						// OK Button
		str+="<div id='cancelBut' class='pa-bs'>Cancel</div></div";				// Cancel
		$("body").append(str+"</div>");											// Add popup
		$("#dialogDiv").offset({ left:x, top:y} );								// Position popup

		$("#okBut").on("click",function() {										// CLICK ON OK
			if (callback)														// If an ok callback spec'd
				callback();														// Run it
			$("#dialogDiv").remove();											// Kill dialog
			});
	
		$("#cancelBut").on("click",function() {									// CLICK ON CANCEL
			if (callback2)														// If a cancel callback spec'd
				callback2();													// Run it
			$("#dialogDiv").remove();											// Kill dialog
			});
	}	

	function trace(msg, p1, p2, p3, p4)										// CONSOLE 
	{
		
		if (p4 != undefined)
			console.log(msg,p1,p2,p3,p4);
		else if (p3 != undefined)
			console.log(msg,p1,p2,p3);
		else if (p2 != undefined)
			console.log(msg,p1,p2);
		else if (p1 != undefined)
			console.log(msg,p1);
		else
			console.log(msg);
	}

	function Sound(sound, mute)												// PLAY SOUND
	{
		var snd=new Audio();													// Init audio object
		if (!snd.canPlayType("audio/mpeg") || (snd.canPlayType("audio/mpeg") == "maybe")) 
			snd=new Audio("img/"+sound+".ogg");									// Use ogg
		else	
			snd=new Audio("img/"+sound+".mp3");									// Use mp3
		if (!mute)	{															// If not initing or muting	
			snd.volume=50/100;													// Set volume
			snd.play();															// Play it
			}
		}

</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-113214874-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-113214874-1');
</script>
</body>
</html>
